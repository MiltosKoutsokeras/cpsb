\documentclass[12pt,twoside,openright]{book}                            
                                                                        
\usepackage[sfdefault]{roboto}   

\usepackage[margin=1in]{geometry}                                       
\setlength\paperwidth{7.5in}                                            
  \setlength\paperheight{9.25in}                                        
 \setlength\textwidth{5.2in}                                            
 \setlength\textheight{7.2in}      

 %Nice header with pages numbers                                         
\usepackage{fancyhdr}                                                   
% Make page number appear on botton right                               
\pagestyle{fancy}                                                       
\fancyfoot{}                                                            
\fancyfoot[EL]{\thepage}                                                
\fancyfoot[OR]{\thepage} 

%------------- IMGs ------------------
\usepackage{graphicx}                                                   
\newcommand{\img}[1]{%
\setlength{\fboxsep}{0pt}%
\setlength{\fboxrule}{1pt}%
\fbox{\includegraphics[width=\textwidth]{\base/illu/img/#1}}%
}%
\newcommand{\draw}[1]{%
\setlength{\fboxsep}{0pt}%
\setlength{\fboxrule}{1pt}%
\fbox{\includegraphics[width=\textwidth]{\base/illu/d/#1.png}}%
}%



%------------- NO BORDER IMG ------------------
\usepackage{graphicx}                                                   
\newcommand{\nbimg}[1]{%
\includegraphics[width=\textwidth]{\base/illu/img/#1}%
}%
\newcommand{\nbdraw}[1]{%
\includegraphics[width=\textwidth]{\base/illu/d/#1.png}%
}%

%------------- SCALED IMG ------------------
\newcommand{\simg}[2]{%
{\centering\includegraphics[width=#1\textwidth]{\base/illu/img/#2}\par}%
}%
\newcommand{\sdraw}[2]{%
{\centering\includegraphics[width=#1\textwidth]{\base/illu/d/#2.png}\par}%
}%



%------------- IMGs ------------------

\newcommand{\red}[1]{%
{\color{red}#1}
}%

%Prevent latex from vertical justifing                                  
\raggedbottom 

\setlength{\parindent}{0em}                                             
\setlength{\parskip}{1em}  

%make footnote stick to the bottom of the page                          
\usepackage[bottom]{footmisc}                                           

% Usage of /href
\usepackage[hidelinks]{hyperref}
% Disable decoration

                                                                        
\usepackage{subfiles}

% ARRAYS
%----------------------------
\usepackage{array}
\usepackage{booktabs}  
% Color header row 
\usepackage[table]{xcolor}
%----------------------------

% Used to force figure to now float (with \begin{figure}[H]).
\usepackage{float}





% Reduce padding between figure and caption
\usepackage{caption}
\captionsetup{belowskip=-15pt, aboveskip=8pt}

% Cover is a pdf that is included
\usepackage{pdfpages}

% quotes
\usepackage{tcolorbox}
\usepackage{xparse}
\NewDocumentEnvironment{q}{m}
{
\begin{tcolorbox}[parbox=false, sharp corners,after skip=10pt]%
}
{ 

\hspace*{\fill} --- #1\\
\end{tcolorbox}%
}

% Help avoiding line overflow
\emergencystretch 1em

% Remove Chapter "chapter" and chapter number
\usepackage{titlesec}
\usepackage{lipsum}
\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Huge}
    
\usepackage{multirow,tabularx} % in the preamble
\newcolumntype{Y}{>{\centering\arraybackslash}X}

% Trivia:
% For trivia left margin
\usepackage{scrextend}
\usepackage{mdframed}
\newmdenv[
  topline=false,
  bottomline=false,
  rightline=false,
]{siderules}

\newenvironment{trivia}{
\begin{siderules}[linewidth=0.7mm,innerrightmargin=0cm,]
\textbf{Trivia:}%
}%
{\end{siderules}}%

% Bibliography
\usepackage[super,square]{natbib}
\bibliographystyle{unsrt}

% To enable figures at the bottom of page
\usepackage{dblfloatfix}

\definecolor{code_bg_color}{HTML}{CCCCCC}
\usepackage{listings}
\lstset{ 
  backgroundcolor=\color{code_bg_color},
  breaklines=false,
   frame=single,
   basicstyle=\small\ttfamily,
   xleftmargin=9pt,
   framexleftmargin=5pt,
   showstringspaces=false,
   aboveskip=12pt,
   belowskip=0pt,
   moredelim=**[is][\color{red}]{@r}{@r},
   moredelim=**[is][\color{green}]{@g}{@g},
   moredelim=**[is][\color{blue}]{@b}{@b},
   moredelim=**[is][\textbf]{@h}{@h},
}

\lstdefinelanguage{z80}{
    morekeywords={call, ld, or, jr,ldr, str,ldir},
    sensitive=false, % keywords are not case-sensitive
    morecomment=[l]{;}, % l is for line comment
 %   morestring=[b]" % defines that strings are enclosed in double quotes
}%

% KANJIS!
\usepackage{CJKutf8}

% Inline code
\usepackage{xcolor}
\definecolor{code_bg_color}{HTML}{CCCCCC}
% \newcommand*{\icode}[1]{\setlength{\fboxsep}{1.0pt}\setlength{\fboxrule}{0.0pt}\fcolorbox{black}{code_bg_color}{\textcolor{black}{\vphantom{g}\vphantom{h}\texttt{#1}}}}

\usepackage{tcolorbox}
\newtcbox{\entoure}[1][code_bg_color]{on line,
arc=3pt,colback=#1!10!code_bg_color,colframe=#1!50!code_bg_color,
before upper={\rule[-3pt]{0pt}{12pt}},boxrule=0pt,
boxsep=0pt,left=2pt,right=2pt,top=2pt,bottom=.5pt}

% layer colors
\definecolor{mycyan}{HTML}{00FFFF}
\definecolor{mypink}{HTML}{FF00FF}

\newcommand*{\icode}[1]{\entoure{\texttt{#1}}}

% Place lstlisting inside minipage to avoid page break inside listing
\lstnewenvironment{code}
{\minipage{\linewidth}}
{\endminipage}

\begin{document}    

\includepdf{\base/illu/cover_front.pdf}

\tableofcontents 

\subfile{src/forewords}
\subfile{src/aknowledgments}
\subfile{src/bug_reports}
\subfile{src/cheat_sheet}
\subfile{src/introduction}
\subfile{src/hardware}
% \subfile{src/teamwork} // TODO extract stuff from here.
\subfile{src/programing}
\subfile{src/prog_z80}
\subfile{src/prog_68000}
\subfile{src/appendix}

\subfile{src/bib}

\includepdf{\base/illu/cover_back.pdf}
\end{document}